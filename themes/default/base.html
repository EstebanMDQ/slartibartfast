<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ meta.title | default(site.config.title | default("TechBlog")) }}{% endblock %}</title>
    {% if meta.description %}
    <meta name="description" content="{{ meta.description }}">
    {% endif %}

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="{{ meta.title | default(site.config.title | default('TechBlog')) }}">
    {% if meta.description %}
    <meta property="og:description" content="{{ meta.description }}">
    {% endif %}

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="{{ meta.title | default(site.config.title | default('TechBlog')) }}">
    {% if meta.description %}
    <meta property="twitter:description" content="{{ meta.description }}">
    {% endif %}

    <link rel="sitemap" type="application/xml" href="{{ site.sitemap_url }}">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'media', // Enable automatic dark mode based on OS preference
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                        'mono': ['JetBrains Mono', 'Fira Code', 'monospace'],
                    },
                    colors: {
                        'tech': {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a',
                        }
                    }
                }
            }
        }
    </script>

    <!-- Inter Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- JetBrains Mono for code -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Prism.js for syntax highlighting - Dark and Light themes -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" media="(prefers-color-scheme: dark)">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" media="(prefers-color-scheme: light)">

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <!-- Theme stylesheets -->
    <link rel="stylesheet" href="/assets/style.css" />
</head>
<body class="bg-white dark:bg-tech-900 text-tech-800 dark:text-tech-200 font-sans antialiased transition-colors duration-300">
    <!-- Header -->
    <header class="border-b border-tech-200 dark:border-tech-700 bg-white/80 dark:bg-tech-900/80 backdrop-blur-sm sticky top-0 z-50">
        <nav class="max-w-4xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo/Brand -->
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">&
                        <span class="text-white font-bold text-sm">T</span>
                    </div>
                    <a href="/" class="text-xl font-bold text-tech-900 dark:text-tech-100 hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
                        {{ site.config.title | default("TechBlog") }}
                    </a>
                </div>

                <!-- Navigation -->
                <ul class="flex items-center space-x-8">
                    {% for nav_item in navigation %}
                    <li>
                        <a href="{{ nav_item.url }}"
                           class="text-tech-600 dark:text-tech-400 hover:text-tech-900 dark:hover:text-tech-100 font-medium transition-colors duration-200 relative group {% if nav_item.active %}text-blue-600 dark:text-blue-400{% endif %}">
                            {{ nav_item.title }}
                            {% if nav_item.active %}
                            <span class="absolute -bottom-1 left-0 w-full h-0.5 bg-blue-600 dark:bg-blue-400 rounded-full"></span>
                            {% endif %}
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class=" dark:bg-tech-900 dark:text-white">
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="bg-tech-50 dark:bg-tech-800 border-t border-tech-200 dark:border-tech-700 mt-16">
        <div class="max-w-4xl mx-auto px-6 py-12">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center space-y-4 md:space-y-0">
                <div class="flex items-center space-x-3">
                    <div class="w-6 h-6 bg-gradient-to-br from-blue-500 to-purple-600 rounded flex items-center justify-center">
                        <span class="text-white font-bold text-xs">T</span>
                    </div>
                    <span class="text-tech-600 dark:text-tech-400 font-medium">{{ site.config.title | default("TechBlog") }}</span>
                </div>

                <div class="flex items-center space-x-6 text-sm text-tech-500 dark:text-tech-400">
                    <span>Â© 2025</span>
                    <a href="{{ site.sitemap_url }}" class="hover:text-tech-700 dark:hover:text-tech-300 transition-colors">Sitemap</a>
                    <span>Powered by <a href="#" class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors">Slartibartfast</a></span>
                </div>
            </div>
        </div>
    </footer>

    <!-- Prism.js for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/normalize-whitespace/prism-normalize-whitespace.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#3b82f6',
                primaryTextColor: '#1e293b',
                primaryBorderColor: '#3b82f6',
                lineColor: '#64748b',
                secondaryColor: '#f1f5f9',
                tertiaryColor: '#f8fafc'
            }
        });

        // Enhance code blocks
        document.addEventListener('DOMContentLoaded', function() {
            // Add language indicators to code blocks
            document.querySelectorAll('pre[class*="language-"]').forEach(function(pre) {
                const language = pre.className.match(/language-(\w+)/);
                if (language) {
                    pre.setAttribute('data-language', language[1]);
                }
            });

            // Add copy buttons to code blocks
            document.querySelectorAll('pre').forEach(function(pre) {
                const wrapper = document.createElement('div');
                wrapper.className = 'code-block-wrapper';
                pre.parentNode.insertBefore(wrapper, pre);
                wrapper.appendChild(pre);

                const copyButton = document.createElement('button');
                copyButton.className = 'copy-button';
                copyButton.textContent = 'Copy';
                copyButton.setAttribute('aria-label', 'Copy code to clipboard');

                copyButton.addEventListener('click', function() {
                    const code = pre.querySelector('code');
                    const text = code ? code.textContent : pre.textContent;

                    navigator.clipboard.writeText(text).then(function() {
                        copyButton.textContent = 'Copied!';
                        setTimeout(function() {
                            copyButton.textContent = 'Copy';
                        }, 2000);
                    }).catch(function(err) {
                        console.error('Failed to copy: ', err);
                        copyButton.textContent = 'Failed';
                        setTimeout(function() {
                            copyButton.textContent = 'Copy';
                        }, 2000);
                    });
                });

                wrapper.appendChild(copyButton);
            });

            // Process Mermaid diagrams
            document.querySelectorAll('code.language-mermaid').forEach(function(code) {
                const pre = code.parentElement;
                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = code.textContent;
                pre.parentNode.replaceChild(mermaidDiv, pre);
            });

            // Re-render Mermaid diagrams
            if (typeof mermaid !== 'undefined') {
                mermaid.init();
            }
        });

        // Prism configuration
        if (typeof Prism !== 'undefined') {
            Prism.plugins.NormalizeWhitespace.setDefaults({
                'remove-trailing': true,
                'remove-indent': true,
                'left-trim': true,
                'right-trim': true
            });
        }
    </script>

<!-- Theme JavaScript -->
<script src="/assets/theme.js"></script>

</body>
</html>
